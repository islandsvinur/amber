\chapter{Detailed design}

In this chapter, every single code object is described in terms of public
interface and functionality. Because of the fairly dynamic character of this
project -- new ideas come and go -- this chapter will not be finished until the
end of the project and will probably change regularly.

\section{Files and directories}

All source code will be in the directory \texttt{src/}. All classes are in the
package \texttt{amber} or in a subpackage thereof. The Psyclone specification
file \texttt{psySpec.xml} is found in \texttt{data/}. External libraries that
are redistributed with \Amber\ are in \texttt{lib/}. The source of this
document, the traineeship report and the website are located in
\texttt{documentation/}.

The application is built using Apache
Ant\footnote{\url{http://ant.apache.org/}} and it can be imported into
Eclipse\footnote{\url{http://www.eclipse.org/}}. It requires Java SDK version
1.5 or greater.

\section{Classes}

Since the project is written in Java, the code objects are classes. This
section deals mainly with the relation between the class hierarchies and their
function.

\subsection{Launcher class hierarchy}

The Launcher is a class which provides an interface to the command line and is
responsible for starting and stopping the program. It has a command line
argument parser which makes unwanted hard coding of parameters largely
unneccesary.

There are three subclasses of Launcher, one for each application executable. In
Figure~\ref{fig:class-diagram-launcher}, a UML diagram of the class hierarchy
is displayed, including public interface.

\begin{figure}[htp]
  \centering
  \includegraphics{image/class-diagram-launcher}
  \caption{
    \label{fig:class-diagram-launcher}
    The inheritance model of the Launcher class}
\end{figure}

\subsection{Module class hierarchy}

The Module family is the collection of classes which can perform a production
task within the \Amber\ system. The first distinction is the general
functionality: crawling, analysing and visualising.

Secondly, as there can be more than one means to do one of the three main
tasks, a class can extend one of these main modules. Thus we get the UML
inheritance model as displayed in Figure~\ref{fig:class-diagram-module}.

\begin{figure}[htp]
  \centering
  \includegraphics{image/class-diagram-module}
  \caption{
    \label{fig:class-diagram-module}
    The inheritance model of the Module class}
\end{figure}

\subsection{AmberMessage class hierarchy}

AmberMessage objects are the holders of information sent and received via
Psyclone. They provide means of (de)serializing data to and from Psyclone and
in this way are a abstraction of the raw messages to the level of Java.

There are two subclasses of AmberMessage, Story and Analysis, which are to be
used for posting on the WB.Stories and WB.Analyses whiteboards respectively.

A Module can introduce extra subclasses if it needs so for sending and
receiving configuration data over Psyclone.

The UML inheritance model is shown in
Figure~\ref{fig:class-diagram-ambermessage}.

\begin{figure}[htp]
  \centering
  \includegraphics{image/class-diagram-ambermessage}
  \caption{
    \label{fig:class-diagram-ambermessage}
    The inheritance model of the AmberMessage class}
\end{figure}

\subsection{Other classes}

There are classes which directly extend from the Java Object class and are as
such outside the \Amber\ hierarchy. They are displayed in
Figure~\ref{fig:class-diagram}.

The first is the Particle class, it represents a particle in the visualisation
module. It is initialized to be ``on the surface of the earth'', then launch
parameters are set according to the result of the first analysis which came in
and it is launched. It will calculate its new position when the visualiser
requests so.

Another class is the AirBrush class, which eases communication with the Java
OpenAIR library.

Lastly, there is the EarthView class which is a Swing component to be placed in
a window, which will draw Particles as they orbit around the earth.

\begin{figure}[htp]
  \centering
  \includegraphics{image/class-diagram}
  \caption{
    \label{fig:class-diagram}
    The inheritance model of the remaining classes}
\end{figure}

The next sections describe all classes in more detail, based on their location
in the code base.

\input{05/classes/amber.inc}

\input{05/classes/amber.common.inc}

\input{05/classes/amber.crawler.inc}

\input{05/classes/amber.sieve.inc}

\input{05/classes/amber.showoff.inc}


\section{Sequences}

This section describes the main courses of events

\input{05/sequences/01-crawler-lifecycle.inc}

\input{05/sequences/02-sieve-lifecycle.inc}

\input{05/sequences/03-showoff-lifecycle.inc}

